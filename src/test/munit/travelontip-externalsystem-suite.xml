<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="travelontip-externalsystem-suite.xml" />
	<munit:test name="try-test" doc:id="d7cf2344-e17d-490d-8e4a-fd71af795845" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Flow Reference" doc:id="04140311-e56a-4065-b2de-3e5362621620" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="7e01fdb2-65d5-4064-9335-0e25bea21137" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[output application/json  --- readUrl('classpath://trytest\mock_payload1.dwl')]" mediaType="application/json " encoding="UTF-8" />
					<munit-tools:variables >
						<munit-tools:variable key="serviceType" value="#[output application/java --- readUrl('classpath://trytest\mock_variable_2.dwl')]" mediaType="application/java" encoding="UTF-8" />
						<munit-tools:variable key="transactionId" value="#[output application/json --- readUrl('classpath://trytest\mock_variable_3.dwl')]" mediaType="application/json" encoding="UTF-8" />
					</munit-tools:variables>
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:spy doc:name="Spy Transform Message" doc:id="ec9ee58a-bbf5-4290-8e6d-4b5cbee0deb2" processor="ee:transform">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="45297b28-e2ab-480b-ac13-07b996e31bfd" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:before-call >
					<munit-tools:assert doc:name="Assert payload" doc:id="86450d78-d4cd-4a41-a4bc-52c072c93c67" message="The payload does not match">
						<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest::spy_assert_payload
---
spy_assert_payload::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:before-call>
				<munit-tools:after-call >
					<munit-tools:assert doc:name="Assert payload" doc:id="8ea4864e-9839-41e9-bc19-c38209079cd9" message="The payload does not match">
						<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest::spy_assert_payload1
---
spy_assert_payload1::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:after-call>
			</munit-tools:spy>
			<munit:set-event doc:name="Set Input" doc:id="5063ff63-2b94-4c0b-a8a4-02730ba9bc97" >
				<munit:payload value="#[readUrl('classpath://trytest\set-event_payload1.dwl')]" encoding="UTF-8" />
				<munit:attributes value="#[readUrl('classpath://trytest\set-event_attributes1.dwl')]" />
			</munit:set-event>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to try" doc:id="f2a98485-2a66-4eb8-a4f4-790492e51310" name="try"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert payload" doc:id="e005852f-b5da-4094-b121-b93fdb5c65fa" message="The payload does not match">
				<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest::assert_expression_payload1
---
assert_expression_payload1::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
			</munit-tools:assert>
			<munit-tools:verify-call doc:name="Verify Transform Message" doc:id="86cacd98-ac82-4188-a675-21cb110d5455" processor="ee:transform" times="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="45297b28-e2ab-480b-ac13-07b996e31bfd" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>
	<munit:test name="try-test1" doc:id="5451d25f-8674-450c-8275-3ded57f52188" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Flow Reference" doc:id="8bb910c2-6d9d-461e-9839-f76fd35425ab" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="73a7be51-c301-4209-ad16-6656b16775bb" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[output application/json  --- readUrl('classpath://trytest1\mock_payload1.dwl')]" mediaType="application/json " encoding="UTF-8" />
					<munit-tools:variables >
						<munit-tools:variable key="serviceType" value="#[output application/java --- readUrl('classpath://trytest1\mock_variable_2.dwl')]" mediaType="application/java" encoding="UTF-8" />
						<munit-tools:variable key="transactionId" value="#[output application/json --- readUrl('classpath://trytest1\mock_variable_3.dwl')]" mediaType="application/json" encoding="UTF-8" />
					</munit-tools:variables>
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:spy doc:name="Spy Transform Message" doc:id="746bd3ed-11f4-4a0a-91ce-1fe4042e1a46" processor="ee:transform">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="45297b28-e2ab-480b-ac13-07b996e31bfd" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:before-call >
					<munit-tools:assert doc:name="Assert payload" doc:id="aeae3436-6b50-405c-9009-d3d02e577307" message="The payload does not match">
						<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest1::spy_assert_payload
---
spy_assert_payload::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:before-call>
				<munit-tools:after-call >
					<munit-tools:assert doc:name="Assert payload" doc:id="6a99a8a7-5d51-44e0-ba45-eaee77274173" message="The payload does not match">
						<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest1::spy_assert_payload1
---
spy_assert_payload1::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:after-call>
			</munit-tools:spy>
			<munit:set-event doc:name="Set Input" doc:id="a813b755-4044-49fe-b802-a3a3b8523957" >
				<munit:payload value="#[readUrl('classpath://trytest1\set-event_payload1.dwl')]" encoding="UTF-8" />
				<munit:attributes value="#[readUrl('classpath://trytest1\set-event_attributes1.dwl')]" />
			</munit:set-event>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to try" doc:id="868b2396-3141-46e9-a75c-1f4b872916aa" name="try"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert payload" doc:id="8171f1c8-3230-43ba-9234-e2998d2224e6" message="The payload does not match">
				<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest1::assert_expression_payload1
---
assert_expression_payload1::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
			</munit-tools:assert>
			<munit-tools:verify-call doc:name="Verify Transform Message" doc:id="c5945f32-9c45-4a7d-ac5b-908a0d6bae3f" processor="ee:transform" times="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="45297b28-e2ab-480b-ac13-07b996e31bfd" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>
	<munit:test name="try-test2" doc:id="4befe7dd-1430-445f-8d39-983b369f90eb" >
		<munit:behavior >
			<munit-tools:spy doc:name="Spy Transform Message" doc:id="afdf1e93-c715-4c49-9303-9fe96be37977" processor="ee:transform">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="45297b28-e2ab-480b-ac13-07b996e31bfd" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:before-call >
					<munit-tools:assert doc:name="Assert payload" doc:id="115a3a36-9828-4dd2-893f-74b8ee3a9205" message="The payload does not match">
						<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest2::spy_assert_payload
---
spy_assert_payload::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:before-call>
				<munit-tools:after-call >
					<munit-tools:assert doc:name="Assert payload" doc:id="58065e70-55e1-407e-b41c-a288f096fd9a" message="The payload does not match">
						<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest2::spy_assert_payload1
---
spy_assert_payload1::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:after-call>
			</munit-tools:spy>
			<munit:set-event doc:name="Set Input" doc:id="afb5d58b-7952-4acf-baff-266400b92597" >
				<munit:payload value="#[readUrl('classpath://trytest2\set-event_payload.dwl')]" encoding="UTF-8" />
				<munit:attributes value="#[readUrl('classpath://trytest2\set-event_attributes.dwl')]" />
			</munit:set-event>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to try" doc:id="b8dd8309-697d-4a8f-a1c0-7d8796e5ec12" name="try"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert payload" doc:id="671f5894-3540-491e-84b3-048e0e27c3b0" message="The payload does not match">
				<munit-tools:that ><![CDATA[#[%dw 2.0
import trytest2::assert_expression_payload
---
assert_expression_payload::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
			</munit-tools:assert>
			<munit-tools:verify-call doc:name="Verify Logger" doc:id="d98c6109-77ed-4934-bc13-309ab07c47d3" processor="logger" times="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="c14f0ecf-1c89-449a-9201-2f975c4bfbf7" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
			<munit-tools:verify-call doc:name="Verify Transform Message" doc:id="663890fb-805c-49ec-a676-f0128d0410ac" processor="ee:transform" times="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="45297b28-e2ab-480b-ac13-07b996e31bfd" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>


</mule>
